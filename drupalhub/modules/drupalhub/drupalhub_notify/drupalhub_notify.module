<?php
/**
 * @file
 * Main module file for notifying users on actions which they concerned to them.
 */

include_once('drupalhub_notify.features.inc');

/**
 * Implements hook_node_insert().
 */
function drupalhub_notify_node_insert($node) {
  drupalhub_core_load_socketio();

  // Creating an object to notify other listeners.
  $json = json_encode((object) [
    'title' => $node->title,
    'uid' => $node->uid,
    'nid' => $node->nid,
  ]);

  // Notify.
  // todo: don't hard code the address.
  $socketio = new SocketIO();
  $socketio->send('localhost', 3000, 'new node', $json);
}
